<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Multilevel Propensity Score Analysis • multilevelPSA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multilevel Propensity Score Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multilevelPSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/multilevelPSA.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jbryer/multilevelPSA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multilevel Propensity Score Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jbryer/multilevelPSA/blob/HEAD/vignettes/multilevelPSA.Rmd" class="external-link"><code>vignettes/multilevelPSA.Rmd</code></a></small>
      <div class="d-none name"><code>multilevelPSA.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Given the large amount of data to be summarized, the use of graphics
are an integral component of representing the results. Pruzek and
Helmreich (2009) introduced a class of graphics for visualizing
dependent sample tests (see also Pruzek &amp; Helmreich, 2010; Danielak,
Pruzek, Doane, Helmreich, &amp; Bryer, 2011). This framework was then
extended for propensity score methods using stratification (Helmreich
&amp; Pruzek, 2009). In particular, the representation of confidence
intervals relative to the unit line (i.e. the line y=x) provided a new
way of determining whether there is a statistically significant
diﬀerence between two groups. The <code>multilevelPSA</code> package
provides a number of graphing functions that extend these frameworks for
multilevel PSA. The figure below represents a multilevel PSA assessment
plot with annotations. This graphic represents the results of comparing
private and public schools in North America using the Programme of
International Student Assessment (PISA; Organisation for Economic
Co-Operation and Development, 2009). The PISA data to create this
graphic are included in the <code>multilevelPSA</code> package and a
more detailed description of how to create this graphic are discussed in
the next section. Additionally, the use of PISA makes more visible
certain features of the graphics used. As discussed in chapters four and
five, the diﬀerences between charter and traditional public schools is
minimal and therefore some features of the figures are less apparent.
The following section focuses on the features of this graphic.</p>
<p>In the figure below, the <em>x</em>-axis corresponds to math scores
for private schools and the y-axis corresponds to public school maths
cores. Each colored circle (a) is a country with its size corresponding
to the number of students sampled within each country. Each country is
projected to the lower left, parallel to the unit line, such that a tick
mark is placed on the line with slope -1 (b). These tick marks represent
the distribution of diﬀerences between private and public schools across
countries. Diﬀerences are aggregated (and weighted by size) across
countries. For math, the overall adjusted mean for private schools is
487, and the overall adjusted mean for public schools is 459 and
represented by the horizontal (c) and vertical (d) blue lines,
respectively. The dashed blue line parallel to the unit line (e)
corresponds to the overall adjusted mean diﬀerence and likewise, the
dashed green lines (f) correspond to the confidence interval. Lastly,
rug plots along the right and top edges of the graphic (g) correspond to
the distribution of each country’s overall mean private and public
school math scores, respectively.</p>
<p>The figure represents a large amount of data and provides insight
into the data and results. The figure provides overall results that
would be present in a traditional table, for instance the fact that the
green dashed lines do not span the unit line (i.e. y = x) indicates that
there is a statistically significant diﬀerence between the two groups.
However additional information is diﬃcult to convey in tabular format.
For example, the rug plots indicate that the spread in the performance
of both private and public schools across countries is large. Also
observe that Canada, which has the largest PISA scores for both groups,
also has the largest diﬀerence (in favor of private schools) as
represented by the larger distance from the unit line.</p>
<div class="figure" style="text-align: center">
<img src="AnnotatedCircPlot.png" alt="Annotated multilevel PSA assessment plot. This plot compares private schools (x- axis) against public schools (y-axis) for North America from the Programme of International Student Assessment." width="90%"><p class="caption">
Annotated multilevel PSA assessment plot. This plot compares private
schools (x- axis) against public schools (y-axis) for North America from
the Programme of International Student Assessment.
</p>
</div>
</div>
<div class="section level2">
<h2 id="working-example">Working Example<a class="anchor" aria-label="anchor" href="#working-example"></a>
</h2>
<p>The <code>multilevelPSA</code> package includes North American data
from the Programme of International Student Assessment (PISA;
Organisation for Economic Co-Operation and Development, 2009). This data
is made freely available for research and is utilized here so that the R
code is reproducible9. This example compares the performance of private
and public schools clustered by country. Note that PISA provide five
plausible values for the academic scores since students complete a
subset of the total assessment. For simplicity, the math score used for
analysis is the average of these five plausible scores.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jbryer.github.io/multilevelPSA" class="external-link">multilevelPSA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://party.R-forge.R-project.org" class="external-link">party</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pisana</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pisa.psa.cols</span><span class="op">)</span></span>
<span><span class="va">pisana</span><span class="op">$</span><span class="va">MathScore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pisana</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'PV'</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">'MATH'</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span> <span class="op">/</span> <span class="fl">5</span></span></code></pre></div>
<p>The <code>mlpsa.ctree</code> function performs phase I of the
propensity score analysis using classification trees, specifically using
the <code>ctree</code> function in the party package. The getStrata
function returns a data frame with a number of rows equivalent to the
original data frame indicating the stratum for each student.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mlpsa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlpsa.ctree.html">mlpsa.ctree</a></span><span class="op">(</span><span class="va">pisana</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CNT'</span>, <span class="st">'PUBPRIV'</span>, <span class="va">pisa.psa.cols</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                     formula <span class="op">=</span> <span class="va">PUBPRIV</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>                     level2 <span class="op">=</span> <span class="st">'CNT'</span><span class="op">)</span></span>
<span><span class="va">mlpsa.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getStrata.html">getStrata</a></span><span class="op">(</span><span class="va">mlpsa</span>, <span class="va">pisana</span>, level2 <span class="op">=</span> <span class="st">'CNT'</span><span class="op">)</span></span></code></pre></div>
<p>Similarly, the <code>mlpsa.logistic</code> estimates propensity
scores using logistic regression. The <code>getPropensityScores</code>
function returns a data frame with a number of rows equivalent to the
original data frame.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mlpsa.lr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlpsa.logistic.html">mlpsa.logistic</a></span><span class="op">(</span><span class="va">pisana</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CNT'</span>, <span class="st">'PUBPRIV'</span>, <span class="va">pisa.psa.cols</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                           formula <span class="op">=</span> <span class="va">PUBPRIV</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>                           level2 <span class="op">=</span> <span class="st">'CNT'</span><span class="op">)</span></span>
<span><span class="va">mlpsa.lr.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPropensityScores.html">getPropensityScores</a></span><span class="op">(</span><span class="va">mlpsa.lr</span>, nStrata <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mlpsa.lr.df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   level2   ps strata</span></span>
<span><span class="co">#&gt; 1    CAN 0.92      2</span></span>
<span><span class="co">#&gt; 2    CAN 0.94      3</span></span>
<span><span class="co">#&gt; 3    CAN 0.97      4</span></span>
<span><span class="co">#&gt; 4    CAN 0.93      2</span></span>
<span><span class="co">#&gt; 5    CAN 0.84      1</span></span>
<span><span class="co">#&gt; 6    CAN 0.97      4</span></span></code></pre></div>
<p>The <code>covariate.balance</code> function calculates balance
statistics for each covariate by estimating the eﬀect of each covariate
before and after adjustment. The results can be converted to a data
frame to view numeric results or the <code>plot</code> function provides
a balance plot. This figure depicts the eﬀect size of each covariate
before (blue triangle) and after (red circle) propensity score
adjustment. As shown here, the eﬀect size for nearly all covariates is
smaller than the unadjusted eﬀect size. The few exceptions are for
covariates where the unadjusted eﬀect size was already small. There is
no established threshold for what is considered a suﬃciently small eﬀect
size. In general, I recommend adjusted eﬀect sizes less than 0.1 which
reflect less than 1% of variance explained.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.bal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covariate.balance.html">covariate.balance</a></span><span class="op">(</span>covariates <span class="op">=</span> <span class="va">pisana</span><span class="op">[</span>,<span class="va">pisa.psa.cols</span><span class="op">]</span>,</span>
<span>                            treatment <span class="op">=</span> <span class="va">pisana</span><span class="op">$</span><span class="va">PUBPRIV</span>,</span>
<span>                            level2 <span class="op">=</span> <span class="va">pisana</span><span class="op">$</span><span class="va">CNT</span>,</span>
<span>                            strata <span class="op">=</span> <span class="va">mlpsa.df</span><span class="op">$</span><span class="va">strata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">cv.bal</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        covariate es.adj es.adj.wtd es.unadj</span></span>
<span><span class="co">#&gt; 1                    (Intercept)  0.000    0.0e+00      NaN</span></span>
<span><span class="co">#&gt; 2 ST05Q01Yes, more than one year  0.097    2.3e-04    0.287</span></span>
<span><span class="co">#&gt; 3   ST05Q01Yes, one year or less  0.051    6.6e-05    0.220</span></span>
<span><span class="co">#&gt; 4               ST07Q01Yes, once  0.103   -1.1e-03    0.235</span></span>
<span><span class="co">#&gt; 5      ST07Q01Yes, twice or more  0.044   -3.7e-04    0.087</span></span>
<span><span class="co">#&gt; 6         ST10Q01&lt;ISCED level 2&gt;  0.030   -1.7e-04    0.171</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv.bal</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="multilevelPSA_files/figure-html/covariate-balance-1.png" alt="Multilevel PSA balance plot for PISA. The eﬀect sizes (standardized mean diﬀerences) for each covariate are provided before PSA adjustment (blue triangles) and after PSA adjustment (red circles)." width="100%"><p class="caption">
Multilevel PSA balance plot for PISA. The eﬀect sizes (standardized mean
diﬀerences) for each covariate are provided before PSA adjustment (blue
triangles) and after PSA adjustment (red circles).
</p>
</div>
<p>The <code>mlpsa</code> function performs phase II of propensity score
analysis and requires four parameters: the response variable, treatment
indicator, stratum, and clustering indicator. The <code>minN</code>
parameter (which defaults to five) indicates what the minimum stratum
size is to be included in the analysis. For this example, 463, or less
than one percent of students were removed because the stratum (or leaf
node for classification trees) did not contain at least five students
from both the treatment and control groups.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results.psa.math</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlpsa.html">mlpsa</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">mlpsa.df</span><span class="op">$</span><span class="va">MathScore</span>,</span>
<span>                          treatment <span class="op">=</span> <span class="va">mlpsa.df</span><span class="op">$</span><span class="va">PUBPRIV</span>,</span>
<span>                          strata <span class="op">=</span> <span class="va">mlpsa.df</span><span class="op">$</span><span class="va">strata</span>,</span>
<span>                          level2 <span class="op">=</span> <span class="va">mlpsa.df</span><span class="op">$</span><span class="va">CNT</span><span class="op">)</span></span>
<span><span class="co">#&gt; Removed 463 (0.696%) rows due to stratum size being less than 5</span></span></code></pre></div>
<p>The <code>summary</code> function provides the overall treatment
estimates as well as level one and two summaries.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results.psa.math</span><span class="op">)</span></span>
<span><span class="co">#&gt; Multilevel PSA Model of 85 strata for 3 levels.</span></span>
<span><span class="co">#&gt; Approx t: -10.8</span></span>
<span><span class="co">#&gt; Confidence Interval: -31.3, -24.75</span></span>
<span><span class="co">#&gt;    level2  strata Treat Treat.n Control Control.n ci.min ci.max</span></span>
<span><span class="co">#&gt; 1     CAN Overall   579    1625     513     21093    -72  -59.6</span></span>
<span><span class="co">#&gt; 2    &lt;NA&gt;       1   580      28     492      1128     NA     NA</span></span>
<span><span class="co">#&gt; 3    &lt;NA&gt;       2   600       9     476      1326     NA     NA</span></span>
<span><span class="co">#&gt; 4    &lt;NA&gt;       3   585      11     513       630     NA     NA</span></span>
<span><span class="co">#&gt; 5    &lt;NA&gt;       4   571     140     508      2240     NA     NA</span></span>
<span><span class="co">#&gt; 6    &lt;NA&gt;       5   578       8     470       179     NA     NA</span></span>
<span><span class="co">#&gt; 7    &lt;NA&gt;       6   500      19     447       310     NA     NA</span></span>
<span><span class="co">#&gt; 8    &lt;NA&gt;       7   584      83     503      3276     NA     NA</span></span>
<span><span class="co">#&gt; 9    &lt;NA&gt;       8   471       5     464       120     NA     NA</span></span>
<span><span class="co">#&gt; 10   &lt;NA&gt;       9   560      41     526       190     NA     NA</span></span>
<span><span class="co">#&gt; 11   &lt;NA&gt;      10   502      20     463        91     NA     NA</span></span>
<span><span class="co">#&gt; 12   &lt;NA&gt;      11   557      44     517       750     NA     NA</span></span>
<span><span class="co">#&gt; 13   &lt;NA&gt;      12   559      34     521       292     NA     NA</span></span>
<span><span class="co">#&gt; 14   &lt;NA&gt;      13   562       8     489       475     NA     NA</span></span>
<span><span class="co">#&gt; 15   &lt;NA&gt;      14   534      21     463       151     NA     NA</span></span>
<span><span class="co">#&gt; 16   &lt;NA&gt;      15   585     126     520      2134     NA     NA</span></span>
<span><span class="co">#&gt; 17   &lt;NA&gt;      16   566      25     533       245     NA     NA</span></span>
<span><span class="co">#&gt; 18   &lt;NA&gt;      17   613      49     576       137     NA     NA</span></span>
<span><span class="co">#&gt; 19   &lt;NA&gt;      18   563      57     527       659     NA     NA</span></span>
<span><span class="co">#&gt; 20   &lt;NA&gt;      19   598     113     542       318     NA     NA</span></span>
<span><span class="co">#&gt; 21   &lt;NA&gt;      20   629      15     562       143     NA     NA</span></span>
<span><span class="co">#&gt; 22   &lt;NA&gt;      21   589      46     523       398     NA     NA</span></span>
<span><span class="co">#&gt; 23   &lt;NA&gt;      22   594      99     548       194     NA     NA</span></span>
<span><span class="co">#&gt; 24   &lt;NA&gt;      23   580      40     542       183     NA     NA</span></span>
<span><span class="co">#&gt; 25   &lt;NA&gt;      24   581      52     539       342     NA     NA</span></span>
<span><span class="co">#&gt; 26   &lt;NA&gt;      25   582     103     526      1219     NA     NA</span></span>
<span><span class="co">#&gt; 27   &lt;NA&gt;      26   626      11     525       113     NA     NA</span></span>
<span><span class="co">#&gt; 28   &lt;NA&gt;      27   589      35     516       804     NA     NA</span></span>
<span><span class="co">#&gt; 29   &lt;NA&gt;      28   524       5     482        15     NA     NA</span></span>
<span><span class="co">#&gt; 30   &lt;NA&gt;      29   551      12     527       348     NA     NA</span></span>
<span><span class="co">#&gt; 31   &lt;NA&gt;      30   588     145     526      1195     NA     NA</span></span>
<span><span class="co">#&gt; 32   &lt;NA&gt;      31   603     147     545       822     NA     NA</span></span>
<span><span class="co">#&gt; 33   &lt;NA&gt;      32   528      27     528         7     NA     NA</span></span>
<span><span class="co">#&gt; 34   &lt;NA&gt;      33   552      47     510       659     NA     NA</span></span>
<span><span class="co">#&gt; 35    MEX Overall   430    4044     423     34090    -10   -3.1</span></span>
<span><span class="co">#&gt; 36   &lt;NA&gt;       1   516      83     485        13     NA     NA</span></span>
<span><span class="co">#&gt; 37   &lt;NA&gt;       2   491     145     448        89     NA     NA</span></span>
<span><span class="co">#&gt; 38   &lt;NA&gt;       3   494     151     475       178     NA     NA</span></span>
<span><span class="co">#&gt; 39   &lt;NA&gt;       4   418      14     416       154     NA     NA</span></span>
<span><span class="co">#&gt; 40   &lt;NA&gt;       5   454     127     438       484     NA     NA</span></span>
<span><span class="co">#&gt; 41   &lt;NA&gt;       6   453      58     431       635     NA     NA</span></span>
<span><span class="co">#&gt; 42   &lt;NA&gt;       7   496     247     487       293     NA     NA</span></span>
<span><span class="co">#&gt; 43   &lt;NA&gt;       8   483     431     461       871     NA     NA</span></span>
<span><span class="co">#&gt; 44   &lt;NA&gt;       9   472       6     467       110     NA     NA</span></span>
<span><span class="co">#&gt; 45   &lt;NA&gt;      10   461      16     450       121     NA     NA</span></span>
<span><span class="co">#&gt; 46   &lt;NA&gt;      11   481     285     470       696     NA     NA</span></span>
<span><span class="co">#&gt; 47   &lt;NA&gt;      12   474      16     443       112     NA     NA</span></span>
<span><span class="co">#&gt; 48   &lt;NA&gt;      13   405      33     413       943     NA     NA</span></span>
<span><span class="co">#&gt; 49   &lt;NA&gt;      14   432     138     429      1484     NA     NA</span></span>
<span><span class="co">#&gt; 50   &lt;NA&gt;      15   472      99     460       619     NA     NA</span></span>
<span><span class="co">#&gt; 51   &lt;NA&gt;      16   445      78     438       898     NA     NA</span></span>
<span><span class="co">#&gt; 52   &lt;NA&gt;      17   460      34     461       262     NA     NA</span></span>
<span><span class="co">#&gt; 53   &lt;NA&gt;      18   460     113     455       367     NA     NA</span></span>
<span><span class="co">#&gt; 54   &lt;NA&gt;      19   434      53     445       454     NA     NA</span></span>
<span><span class="co">#&gt; 55   &lt;NA&gt;      20   458      69     446       367     NA     NA</span></span>
<span><span class="co">#&gt; 56   &lt;NA&gt;      21   462      76     457       217     NA     NA</span></span>
<span><span class="co">#&gt; 57   &lt;NA&gt;      22   477      93     452       150     NA     NA</span></span>
<span><span class="co">#&gt; 58   &lt;NA&gt;      23   476     186     460       547     NA     NA</span></span>
<span><span class="co">#&gt; 59   &lt;NA&gt;      24   477      10     437       130     NA     NA</span></span>
<span><span class="co">#&gt; 60   &lt;NA&gt;      25   476      80     442       159     NA     NA</span></span>
<span><span class="co">#&gt; 61   &lt;NA&gt;      26   437     167     428      1040     NA     NA</span></span>
<span><span class="co">#&gt; 62   &lt;NA&gt;      27   436     146     435      1175     NA     NA</span></span>
<span><span class="co">#&gt; 63   &lt;NA&gt;      28   442      45     429       406     NA     NA</span></span>
<span><span class="co">#&gt; 64   &lt;NA&gt;      29   424      80     428      1963     NA     NA</span></span>
<span><span class="co">#&gt; 65   &lt;NA&gt;      30   436      61     427       787     NA     NA</span></span>
<span><span class="co">#&gt; 66   &lt;NA&gt;      31   426      48     428       645     NA     NA</span></span>
<span><span class="co">#&gt; 67   &lt;NA&gt;      32   401     231     409      4314     NA     NA</span></span>
<span><span class="co">#&gt; 68   &lt;NA&gt;      33   442      28     438       279     NA     NA</span></span>
<span><span class="co">#&gt; 69   &lt;NA&gt;      34   424      34     426      1013     NA     NA</span></span>
<span><span class="co">#&gt; 70   &lt;NA&gt;      35   420      63     427      2364     NA     NA</span></span>
<span><span class="co">#&gt; 71   &lt;NA&gt;      36   408      18     400       234     NA     NA</span></span>
<span><span class="co">#&gt; 72   &lt;NA&gt;      37   406     107     397      3632     NA     NA</span></span>
<span><span class="co">#&gt; 73   &lt;NA&gt;      38   425      25     412      2434     NA     NA</span></span>
<span><span class="co">#&gt; 74   &lt;NA&gt;      39   449      15     432       342     NA     NA</span></span>
<span><span class="co">#&gt; 75   &lt;NA&gt;      40   362       7     348      1959     NA     NA</span></span>
<span><span class="co">#&gt; 76   &lt;NA&gt;      41   381      15     346      1004     NA     NA</span></span>
<span><span class="co">#&gt; 77   &lt;NA&gt;      42   510     313     488       146     NA     NA</span></span>
<span><span class="co">#&gt; 78    USA Overall   505     345     485      4888    -32   -8.8</span></span>
<span><span class="co">#&gt; 79   &lt;NA&gt;       1   479      50     475      1219     NA     NA</span></span>
<span><span class="co">#&gt; 80   &lt;NA&gt;       2   490      16     448      1323     NA     NA</span></span>
<span><span class="co">#&gt; 81   &lt;NA&gt;       3   502      34     488       462     NA     NA</span></span>
<span><span class="co">#&gt; 82   &lt;NA&gt;       4   528      42     507       263     NA     NA</span></span>
<span><span class="co">#&gt; 83   &lt;NA&gt;       5   512      42     503       335     NA     NA</span></span>
<span><span class="co">#&gt; 84   &lt;NA&gt;       6   520      21     477       526     NA     NA</span></span>
<span><span class="co">#&gt; 85   &lt;NA&gt;       7   565      80     559       278     NA     NA</span></span>
<span><span class="co">#&gt; 86   &lt;NA&gt;       8   560      41     541       207     NA     NA</span></span>
<span><span class="co">#&gt; 87   &lt;NA&gt;       9   511      14     529       259     NA     NA</span></span>
<span><span class="co">#&gt; 88   &lt;NA&gt;      10   522       5     461        16     NA     NA</span></span></code></pre></div>
<p>The <code>plot</code> function creates the multilevel assessment
plot. Here it is depicted with side panels showing the distribution of
math scores for all strata for public school students to the left and
private school students below. These panels can be plotted separately
using the <code>mlpsa.circ.plot</code> and mlpsa.distribution.plot
functions.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results.psa.math</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="multilevelPSA_files/figure-html/psa-circ-plot-1.png" alt="Multilevel PSA assessment plot for PISA. The main panel provides the adjusted mean for private (x-axis) and public (y-axis) for each country. The left and lower panels provide the mean for each stratum for the public and private students, respectively. The overall adjusted mean diﬀerence is represented by the dashed blue line and the 95% confidence interval by the dashed green lines. There is a statistically significant diﬀerence between private and public school student performance as evidenced by the confidence interval not spanning zero (i.e. not crossing the unit line y=x." width="100%"><p class="caption">
Multilevel PSA assessment plot for PISA. The main panel provides the
adjusted mean for private (x-axis) and public (y-axis) for each country.
The left and lower panels provide the mean for each stratum for the
public and private students, respectively. The overall adjusted mean
diﬀerence is represented by the dashed blue line and the 95% confidence
interval by the dashed green lines. There is a statistically significant
diﬀerence between private and public school student performance as
evidenced by the confidence interval not spanning zero (i.e. not
crossing the unit line y=x.
</p>
</div>
<p>Lastly, the <code>mlpsa.difference.plot</code> function plots the
overall diﬀerences. The <code>sd</code> parameter is optional, but if
specified, the x-axis can be interpreted as standardized eﬀect
sizes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mlpsa.difference.plot.html">mlpsa.difference.plot</a></span><span class="op">(</span><span class="va">results.psa.math</span>, </span>
<span>                      sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mlpsa.df</span><span class="op">$</span><span class="va">MathScore</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="multilevelPSA_files/figure-html/difference-plot-1.png" alt="Multilevel PSA diﬀerence plot for PISA. Each blue dot corresponds to the eﬀect size (standardized mean diﬀerence) for each country. The vertical blue line corresponds to the overall eﬀect size for all countries. The green lines correspond to the 95% confidence intervals. The dashed green lines Bonferroni-Sidak (c.f. Abdi, 2007) adjusted confidence intervals. The size of each dot is proportional to the sample size within each country." width="100%"><p class="caption">
Multilevel PSA diﬀerence plot for PISA. Each blue dot corresponds to the
eﬀect size (standardized mean diﬀerence) for each country. The vertical
blue line corresponds to the overall eﬀect size for all countries. The
green lines correspond to the 95% confidence intervals. The dashed green
lines Bonferroni-Sidak (c.f. Abdi, 2007) adjusted confidence intervals.
The size of each dot is proportional to the sample size within each
country.
</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason Bryer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
